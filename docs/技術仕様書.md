# ImageMonitor æŠ€è¡“ä»•æ§˜æ›¸

## æ¦‚è¦
ImageMonitorã¯ã€ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãŠã‚ˆã³ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆZIPã€RARï¼‰ã‚’ç®¡ç†ãƒ»é–²è¦§ã™ã‚‹ãŸã‚ã®WPFã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: .NET 8 (net8.0-windows)
- **UI**: WPF (Windows Presentation Foundation)
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: LiteDB
- **ãƒ­ã‚°**: Serilog

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å…¨ä½“æ§‹æˆ
```
ImageMonitor/
â”œâ”€â”€ src/ImageMonitor/           # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ Models/                 # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ Services/              # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤
â”‚   â”œâ”€â”€ ViewModels/            # MVVM ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ Views/                 # XAML ãƒ“ãƒ¥ãƒ¼
â”‚   â””â”€â”€ Converters/            # å€¤ã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼
â”œâ”€â”€ build/net8.0-windows/      # ãƒ“ãƒ«ãƒ‰å‡ºåŠ›
â””â”€â”€ docs/                      # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

### è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³
- **MVVM (Model-View-ViewModel)**: WPFã®æ¨™æº–çš„ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³
- **Dependency Injection**: Microsoft.Extensions.DependencyInjection
- **Repository Pattern**: ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã®æŠ½è±¡åŒ–
- **Command Pattern**: UIæ“ä½œã®æŠ½è±¡åŒ–

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€  (ERå›³)

```mermaid
erDiagram
    ImageItems ||--o{ ArchiveItems : "belongs_to"
    ScanHistory ||--o{ ImageItems : "scanned_in"
    ScanHistory ||--o{ ArchiveItems : "scanned_in"

    ImageItems {
        string Id PK
        string FilePath
        string FileName
        long FileSize
        datetime CreatedAt
        datetime ModifiedAt
        int Width
        int Height
        string ImageFormat
        string ThumbnailPath
        bool IsArchived
        string ArchivePath
        datetime DateTaken
        bool HasExifData
        string Hash
    }

    ArchiveItems {
        string Id PK
        string FilePath
        string FileName
        long FileSize
        datetime CreatedAt
        datetime ModifiedAt
        int ImageFiles
        string ThumbnailPath
        string Hash
    }

    ScanHistory {
        string Id PK
        datetime ScanStartTime
        datetime ScanEndTime
        int TotalFilesScanned
        int NewFilesAdded
        int UpdatedFiles
        int ErrorCount
        string ScanPath
        string Status
    }
```

## ãƒ‡ãƒ¼ã‚¿æ§‹é€ ä»•æ§˜æ›¸

### Models

#### 1. ImageItem
ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ã‚’æ ¼ç´ã™ã‚‹ãƒ¢ãƒ‡ãƒ«

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | å‹ | èª¬æ˜ | å¿…é ˆ |
|-----------|---|------|------|
| Id | string | ä¸€æ„è­˜åˆ¥å­ (GUID) | â—‹ |
| FilePath | string | ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Œå…¨ãƒ‘ã‚¹ | â—‹ |
| FileName | string | ãƒ•ã‚¡ã‚¤ãƒ«å | â—‹ |
| FileSize | long | ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º (ãƒã‚¤ãƒˆ) | â—‹ |
| CreatedAt | DateTime | ä½œæˆæ—¥æ™‚ | â—‹ |
| ModifiedAt | DateTime | æ›´æ–°æ—¥æ™‚ | â—‹ |
| Width | int | ç”»åƒã®å¹… (ãƒ”ã‚¯ã‚»ãƒ«) | - |
| Height | int | ç”»åƒã®é«˜ã• (ãƒ”ã‚¯ã‚»ãƒ«) | - |
| ImageFormat | string | ç”»åƒå½¢å¼ (.jpg, .pngç­‰) | - |
| ThumbnailPath | string | ã‚µãƒ ãƒã‚¤ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | - |
| IsArchived | bool | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å†…ã‹ã©ã†ã‹ | â—‹ |
| ArchivePath | string | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | - |
| DateTaken | DateTime? | æ’®å½±æ—¥æ™‚ (EXIF) | - |
| HasExifData | bool | EXIF ãƒ‡ãƒ¼ã‚¿ã®æœ‰ç„¡ | â—‹ |
| Hash | string | ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚·ãƒ¥å€¤ | - |

#### 2. ArchiveItem
ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆZIPã€RARï¼‰ã®æƒ…å ±ã‚’æ ¼ç´ã™ã‚‹ãƒ¢ãƒ‡ãƒ«

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | å‹ | èª¬æ˜ | å¿…é ˆ |
|-----------|---|------|------|
| Id | string | ä¸€æ„è­˜åˆ¥å­ (GUID) | â—‹ |
| FilePath | string | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Œå…¨ãƒ‘ã‚¹ | â—‹ |
| FileName | string | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«å | â—‹ |
| FileSize | long | ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º (ãƒã‚¤ãƒˆ) | â—‹ |
| CreatedAt | DateTime | ä½œæˆæ—¥æ™‚ | â—‹ |
| ModifiedAt | DateTime | æ›´æ–°æ—¥æ™‚ | â—‹ |
| ImageFiles | int | å«ã¾ã‚Œã‚‹ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«æ•° | â—‹ |
| ThumbnailPath | string | ã‚µãƒ ãƒã‚¤ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | - |
| Hash | string | ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚·ãƒ¥å€¤ | - |

#### 3. ScanHistory
ã‚¹ã‚­ãƒ£ãƒ³å±¥æ­´ã‚’æ ¼ç´ã™ã‚‹ãƒ¢ãƒ‡ãƒ«

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | å‹ | èª¬æ˜ | å¿…é ˆ |
|-----------|---|------|------|
| Id | string | ä¸€æ„è­˜åˆ¥å­ (GUID) | â—‹ |
| ScanStartTime | DateTime | ã‚¹ã‚­ãƒ£ãƒ³é–‹å§‹æ™‚åˆ» | â—‹ |
| ScanEndTime | DateTime? | ã‚¹ã‚­ãƒ£ãƒ³çµ‚äº†æ™‚åˆ» | - |
| TotalFilesScanned | int | ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ç·æ•° | â—‹ |
| NewFilesAdded | int | æ–°è¦è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«æ•° | â—‹ |
| UpdatedFiles | int | æ›´æ–°ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«æ•° | â—‹ |
| ErrorCount | int | ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿä»¶æ•° | â—‹ |
| ScanPath | string | ã‚¹ã‚­ãƒ£ãƒ³å¯¾è±¡ãƒ‘ã‚¹ | â—‹ |
| Status | string | ã‚¹ã‚­ãƒ£ãƒ³çŠ¶æ…‹ (Running, Completed, Error) | â—‹ |

#### 4. AppSettings
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šã‚’æ ¼ç´ã™ã‚‹ãƒ¢ãƒ‡ãƒ«

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | å‹ | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ |
|-----------|---|------|-------------|
| ScanDirectories | List&lt;string&gt; | ã‚¹ã‚­ãƒ£ãƒ³å¯¾è±¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | ç©ºãƒªã‚¹ãƒˆ |
| ThumbnailSize | int | ã‚µãƒ ãƒã‚¤ãƒ«ã‚µã‚¤ã‚º | 192 |
| DefaultArchiveViewer | string | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ | null |
| Theme | int | ãƒ†ãƒ¼ãƒè¨­å®š | 0 |
| SupportedImageFormats | List&lt;string&gt; | ã‚µãƒãƒ¼ãƒˆç”»åƒå½¢å¼ | [".jpg", ".jpeg", ".png", ".bmp", ".gif", ".webp"] |
| SupportedArchiveFormats | List&lt;string&gt; | ã‚µãƒãƒ¼ãƒˆã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å½¢å¼ | [".zip", ".rar"] |
| GenerateArchiveThumbnails | bool | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆ | true |
| MaxArchiveEntries | int | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æœ€å¤§ã‚¨ãƒ³ãƒˆãƒªæ•° | 10000 |
| WindowWidth | double | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å¹… | 1200 |
| WindowHeight | double | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é«˜ã• | 800 |
| WindowMaximized | bool | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æœ€å¤§åŒ–çŠ¶æ…‹ | false |
| MaxConcurrentScans | int | æœ€å¤§ä¸¦è¡Œã‚¹ã‚­ãƒ£ãƒ³æ•° | 4 |
| ScanTimeout | int | ã‚¹ã‚­ãƒ£ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ(ç§’) | 300 |
| ThumbnailCacheSize | int | ã‚µãƒ ãƒã‚¤ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚º | 1000 |
| CacheCleanupInterval | int | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—é–“éš”(æ™‚é–“) | 24 |
| EnableThumbnailGeneration | bool | ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆæœ‰åŠ¹ | true |
| EnableLogging | bool | ãƒ­ã‚°è¨˜éŒ²æœ‰åŠ¹ | true |
| LogLevel | string | ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« | "Information" |
| MaxLogFiles | int | æœ€å¤§ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«æ•° | 7 |

#### 5. SearchFilter
æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã‚’æ ¼ç´ã™ã‚‹ãƒ¢ãƒ‡ãƒ«

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | å‹ | èª¬æ˜ |
|-----------|---|------|
| Query | string | æ¤œç´¢ã‚¯ã‚¨ãƒªæ–‡å­—åˆ— |
| MinFileSize | long? | æœ€å°ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º |
| MaxFileSize | long? | æœ€å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º |
| DateFrom | DateTime? | é–‹å§‹æ—¥æ™‚ |
| DateTo | DateTime? | çµ‚äº†æ—¥æ™‚ |
| MinWidth | int? | æœ€å°å¹… |
| MaxWidth | int? | æœ€å¤§å¹… |
| MinHeight | int? | æœ€å°é«˜ã• |
| MaxHeight | int? | æœ€å¤§é«˜ã• |
| IncludeArchives | bool | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’å«ã‚€ã‹ |
| ImageRatioThreshold | double | ç”»åƒæ¯”ç‡é–¾å€¤ |
| ImageFormats | List&lt;string&gt; | å¯¾è±¡ç”»åƒå½¢å¼ |
| HasExifData | bool? | EXIF ãƒ‡ãƒ¼ã‚¿ã®æœ‰ç„¡ |
| DateTakenFrom | DateTime? | æ’®å½±æ—¥é–‹å§‹ |
| DateTakenTo | DateTime? | æ’®å½±æ—¥çµ‚äº† |
| SortBy | SortBy | ã‚½ãƒ¼ãƒˆåŸºæº– |
| SortDirection | SortDirection | ã‚½ãƒ¼ãƒˆæ–¹å‘ |
| PageSize | int | ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º |
| PageNumber | int | ãƒšãƒ¼ã‚¸ç•ªå· |

## æ¤œç´¢æ©Ÿèƒ½ã®ä¿®æ­£å±¥æ­´

### ä¿®æ­£å‰ã®å•é¡Œç‚¹
1. **LiteDBã‚¨ãƒ©ãƒ¼**: `System.NotImplementedException` ãŒç™ºç”Ÿ
2. **æ¤œç´¢å¯¾è±¡ã®ä¸ä¸€è‡´**: ImageItemsã‚’å¯¾è±¡ã«ã—ã¦ã„ãŸãŒArchiveItemsãŒå¿…è¦
3. **è‡ªå‹•æ¤œç´¢**: æ–‡å­—å…¥åŠ›ã¨åŒæ™‚ã«æ¤œç´¢ãŒå®Ÿè¡Œã•ã‚Œã‚‹
4. **æ¤œç´¢ç¯„å›²**: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹å…¨ä½“ã‚’æ¤œç´¢å¯¾è±¡ã«ã—ã¦ã„ãŸ

### ä¿®æ­£å†…å®¹

#### 1. LiteDBã‚¯ã‚¨ãƒªã®ä¿®æ­£ (DatabaseService.cs)
```csharp
// ä¿®æ­£å‰: LiteDBã‚¯ã‚¨ãƒªå†…ã§OrderByã‚’å®Ÿè¡Œ
var results = query.OrderBy(GetSortExpression(filter.SortBy)).ToList();

// ä¿®æ­£å¾Œ: ãƒ¡ãƒ¢ãƒªå†…ã§ã‚½ãƒ¼ãƒˆå®Ÿè¡Œ
var results = query.ToList();
switch (filter.SortBy)
{
    case SortBy.FileName:
        results = filter.SortDirection == SortDirection.Ascending 
            ? results.OrderBy(x => x.FileName).ToList()
            : results.OrderByDescending(x => x.FileName).ToList();
        break;
    // ä»–ã®ã‚½ãƒ¼ãƒˆæ¡ä»¶...
}
```

#### 2. æ¤œç´¢å¯¾è±¡ã®å¤‰æ›´
```csharp
// ä¿®æ­£å‰: ImageItemsã‚’æ¤œç´¢
await _databaseService.SearchImageItemsAsync(searchFilter);

// ä¿®æ­£å¾Œ: ArchiveItemsã‚’æ¤œç´¢
await _databaseService.SearchArchiveItemsAsync(searchFilter);
```

#### 3. æ‰‹å‹•æ¤œç´¢ã®å®Ÿè£…
```csharp
// MainViewModel.cs - è‡ªå‹•æ¤œç´¢ã‚’ç„¡åŠ¹åŒ–
private void OnSearchQueryChanged()
{
    // è‡ªå‹•æ¤œç´¢ã‚’ç„¡åŠ¹åŒ– - æ‰‹å‹•æ¤œç´¢ã®ã¿å®Ÿè¡Œ
}

// MainWindow.xaml.cs - Enterã‚­ãƒ¼æ¤œç´¢
private void SearchTextBox_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Enter)
    {
        if (ViewModel.SearchImagesCommand.CanExecute(null))
        {
            ViewModel.SearchImagesCommand.Execute(null);
        }
    }
}
```

#### 4. æ¤œç´¢ç¯„å›²ã®èª¿æ•´
```csharp
// ä¿®æ­£å‰: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹å…¨ä½“ã‚’æ¤œç´¢
query.Where(x => x.FilePath.ToLower().Contains(searchTerm) || 
                 x.FileName.ToLower().Contains(searchTerm))

// ä¿®æ­£å¾Œ: ãƒ•ã‚¡ã‚¤ãƒ«åã®ã¿ã‚’æ¤œç´¢
query.Where(x => x.FileName.ToLower().Contains(searchTerm))
```

#### 5. æ¤œç´¢çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å®Ÿè£…
```csharp
private readonly Dictionary<string, IEnumerable<ArchiveItem>> _searchCache = new();

private async Task SearchImagesAsync()
{
    var cacheKey = $"{searchQuery}_{SortBy}_{SortDirection}";
    if (_searchCache.TryGetValue(cacheKey, out var cachedResults))
    {
        // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰çµæœã‚’å–å¾—
        var cachedItems = cachedResults.Select(CreateDisplayItemFromArchive).ToList();
        await Application.Current.Dispatcher.InvokeAsync(() =>
        {
            DisplayItems.Clear();
            foreach (var item in cachedItems)
            {
                DisplayItems.Add(item);
            }
        });
        return;
    }
    // ... æ¤œç´¢å®Ÿè¡Œã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜
}
```

### ä¿®æ­£çµæœ
- âœ… LiteDBã‚¨ãƒ©ãƒ¼ã®è§£æ¶ˆ
- âœ… æ‰‹å‹•æ¤œç´¢ã®å®Ÿè£…ï¼ˆğŸ”ãƒœã‚¿ãƒ³ã€Enterã‚­ãƒ¼ï¼‰
- âœ… ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«åã§ã®æ¤œç´¢
- âœ… æ¤œç´¢çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
- âœ… æ—¥æœ¬èªæ¤œç´¢å¯¾å¿œï¼ˆã€Œæˆå¹´ã‚³ãƒŸãƒƒã‚¯ã€ç­‰ï¼‰

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
æœ€æ–°ã®ãƒ­ã‚°ã«ã‚ˆã‚‹ã¨ï¼š
- æ¤œç´¢æ™‚é–“: 1000ms-1217ms (è­¦å‘Šãƒ¬ãƒ™ãƒ«)
- æ¤œç´¢çµæœ: 953ä»¶ã€33ä»¶ã®çµæœã‚’æ­£å¸¸å–å¾—
- ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: ãªã—

## WebPç”»åƒå½¢å¼ã‚µãƒãƒ¼ãƒˆè¿½åŠ ä¿®æ­£å±¥æ­´

### èƒŒæ™¯
WebPãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œãªã„å•é¡ŒãŒç™ºç”Ÿã€‚

### å•é¡Œç‚¹
1. **ç”»åƒå½¢å¼æœªã‚µãƒãƒ¼ãƒˆ**: AppSettingsã§WebPãŒæœªå®šç¾©
2. **ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼**: WPF BitmapDecoderãŒWebPã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„
3. **ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å‡¦ç†ä¸å®Œå…¨**: ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ãŒã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã«æ­£ã—ãæ¸¡ã•ã‚Œã¦ã„ãªã„

### ä¿®æ­£å†…å®¹

#### 1. ç”»åƒå½¢å¼ã‚µãƒãƒ¼ãƒˆæ‹¡å¼µ
```csharp
// AppSettings.cs - ã‚µãƒãƒ¼ãƒˆå½¢å¼ã«WebPã‚’è¿½åŠ 
public List<string> SupportedImageFormats { get; set; } = new()
{
    ".jpg", ".jpeg", ".png", ".bmp", ".gif", ".webp"
};

// ImageScanService.cs - WebPèªè­˜
private static readonly string[] SupportedImageExtensions = 
    { ".jpg", ".jpeg", ".png", ".bmp", ".gif", ".webp" };
```

#### 2. ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã®æ”¹å–„
```csharp
// ThumbnailService.cs - ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¿½åŠ 
private async Task<string?> GenerateThumbnailFromStreamAsync(
    Stream imageStream, string thumbnailPath, int size, string fileExtension = "")

// WebPç”¨ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
if (fileExtension.ToLower() == ".webp")
{
    try
    {
        decoder = BitmapDecoder.Create(imageStream, ...);
    }
    catch (NotSupportedException)
    {
        _logger.LogWarning("WebP format not supported by current WPF decoder");
        return null;
    }
}
```

#### 3. ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å‡¦ç†ã®ä¿®æ­£
```csharp
// ZIPå‡¦ç† - æ‹¡å¼µå­ã‚’å–å¾—ã—ã¦æ¸¡ã™
var firstImageEntry = imageEntries.First();
var imageExtension = Path.GetExtension(firstImageEntry.FullName);
return await GenerateThumbnailFromStreamAsync(memoryStream, thumbnailPath, size, imageExtension);

// RARå‡¦ç† - åŒæ§˜ã«ä¿®æ­£
var imageExtension = Path.GetExtension(firstImageEntry.Key);
return await GenerateThumbnailFromStreamAsync(memoryStream, thumbnailPath, size, imageExtension);
```

### ä¿®æ­£çµæœ
- âœ… **WebPãƒ•ã‚¡ã‚¤ãƒ«èªè­˜**: ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å†…WebPãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸è­˜åˆ¥
- âœ… **ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤º**: WebPã‚’å«ã‚€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã®ã‚µãƒ ãƒã‚¤ãƒ«ã‚«ãƒ¼ãƒ‰ãŒè¡¨ç¤º
- âœ… **ç”»åƒè¡¨ç¤º**: WebPãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿéš›ã®ç”»åƒãŒæ­£å¸¸è¡¨ç¤º
- âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: WebPéã‚µãƒãƒ¼ãƒˆç’°å¢ƒã§ã®é©åˆ‡ãªè­¦å‘Šå‡ºåŠ›

### æŠ€è¡“çš„è©³ç´°
- **å¯¾å¿œãƒ•ã‚¡ã‚¤ãƒ«**: AppSettings.cs, ImageScanService.cs, ThumbnailService.cs
- **äº’æ›æ€§**: WebPã‚³ãƒ¼ãƒ‡ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ç’°å¢ƒã§å‹•ä½œ
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: éã‚µãƒãƒ¼ãƒˆç’°å¢ƒã§ã¯è­¦å‘Šãƒ­ã‚°ã§ã‚¹ã‚­ãƒƒãƒ—
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: æ—¢å­˜ã®ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆãƒ•ãƒ­ãƒ¼ã«å½±éŸ¿ãªã—

## ä»Šå¾Œã®æ”¹å–„ç‚¹
1. æ¤œç´¢ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æœ€é©åŒ–ï¼ˆ1ç§’ä»¥ä¸‹ã‚’ç›®æ¨™ï¼‰
2. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è¿½åŠ ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
3. å…¨æ–‡æ¤œç´¢æ©Ÿèƒ½ã®å®Ÿè£…
4. æ­£è¦è¡¨ç¾æ¤œç´¢ã®å¯¾å¿œ
5. WebPã‚³ãƒ¼ãƒ‡ãƒƒã‚¯è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ©Ÿèƒ½ã®æ¤œè¨
