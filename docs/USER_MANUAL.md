# ImageMonitor ユーザーマニュアル

## 📖 概要

ImageMonitorは、画像ファイルとアーカイブ（ZIP/RAR）内の画像を効率的に管理・検索できるアプリケーションです。MovieMonitorをベースに、アーカイブファイル対応を追加した画像管理ツールです。

## 🚀 初回セットアップ

### 1. アプリケーション起動
- `ImageMonitor.exe`を実行
- 初回起動時は空の状態で表示されます

### 2. スキャン対象フォルダの設定
1. **メニューバー** → **ファイル** → **設定** をクリック
2. **スキャン設定**タブを選択
3. **「追加」**ボタンをクリックしてフォルダを選択
4. 複数のフォルダを追加可能
5. **「OK」**ボタンで設定を保存

### 3. 初回スキャンの実行
1. **ツールバー**の **「Scan」**ボタンをクリック
2. または **メニューバー** → **ツール** → **スキャン実行**
3. スキャン進捗がステータスバーに表示されます
4. 完了まで待機（大量のファイルがある場合は時間がかかります）

## 🔍 基本的な使い方

### 画像の表示と閲覧
- **メインエリア**にサムネイル形式で画像が表示されます
- **ダブルクリック**で関連アプリケーションで開く
- **右クリック**でコンテキストメニュー表示

### 検索とフィルタリング

#### **1. テキスト検索**
- **検索ボックス**にファイル名の一部を入力
- リアルタイムで検索結果が更新されます
- **「Clear」**ボタンで検索をクリア

#### **2. Include Archives チェックボックス**
- ✅ **ON**: アーカイブ内画像も表示（デフォルト）
- ❌ **OFF**: フォルダ内の直接画像のみ表示

#### **3. Image Ratio スライダー**
- アーカイブの画像比率閾値を調整（0% - 100%）
- 50%設定 = アーカイブ内の50%以上が画像ファイルの場合のみ対象
- 値を下げると、画像の少ないアーカイブも検索対象に含まれます

## 📁 ファイル操作

### 画像を開く
1. **ダブルクリック**または**右クリック** → **「Open Image」**
2. 通常画像：既定の画像ビューワーで表示
3. アーカイブ内画像：関連付けられたアーカイブビューワーで表示

### フォルダを開く
1. **右クリック** → **「Open Folder」**
2. 通常画像：ファイルがあるフォルダを開く
3. アーカイブ内画像：アーカイブファイルを選択状態でフォルダを開く

## ⚙️ 詳細設定

### スキャン設定
- **スキャン対象フォルダ**: 複数フォルダの追加・削除
- **アーカイブ設定**: 画像比率閾値の調整

### サムネイル設定
- **サムネイル生成**: 有効/無効の切り替え
- **サムネイルサイズ**: 64px～256pxの選択
- **キャッシュ管理**: 手動クリア、古いキャッシュ削除

### 表示設定
- **ウィンドウサイズ**: 起動時のサイズ設定
- **最大化**: 起動時の状態設定

### ログ設定
- **ログレベル**: 詳細度の調整
- **保持日数**: ログファイルの保管期間

## 📊 画面の説明

### メインウィンドウの構成

```
┌─────────────────────────────────────┐
│ [File] [Tools] [Help]               │ ← メニューバー
├─────────────────────────────────────┤
│ [Scan] [Refresh] | [検索ボックス]    │ ← ツールバー
│ □Include Archives [■■■] 50%         │ ← フィルター
├─────────────────────┬───────────────┤
│ [サムネイル表示]     │ Properties    │ ← メインエリア
│ [░░░] [░░░] [░░░]   │ Name: xxx.jpg │ ← プロパティパネル
│ [░░░] [░░░] [░░░]   │ Size: 1.2MB   │
│                     │ Resolution:   │
├─────────────────────┴───────────────┤
│ Ready                    1234 items │ ← ステータスバー
└─────────────────────────────────────┘
```

### アイコンとボタンの説明

| ボタン/項目 | 機能 |
|------------|------|
| **Scan** | 新しい画像ファイル・アーカイブをスキャン |
| **Refresh** | 表示を最新状態に更新 |
| **Clear** | 検索条件をクリア |
| **Include Archives** | アーカイブ内画像の表示/非表示切り替え |
| **Image Ratio** | アーカイブの画像比率閾値設定 |

## 🔧 トラブルシューティング

### よくある問題

#### Q: 画像が表示されない
A: 以下を確認してください
1. スキャン対象フォルダが正しく設定されているか
2. スキャンが完了しているか（ステータス確認）
3. フィルター設定（Include Archives、Image Ratio）

#### Q: アーカイブ内の画像が表示されない
A: 
1. **Include Archives**がチェックされているか確認
2. **Image Ratio**スライダーを下げてみる（10-20%程度）
3. 対応アーカイブ形式を確認（ZIP/RARのみ対応）

#### Q: スキャンが失敗する
A:
1. フォルダのアクセス権限を確認
2. ファイルが他のアプリで使用中でないか確認
3. ログファイルでエラー詳細を確認（`%AppData%\ImageMonitor\Logs\`）

#### Q: サムネイルが表示されない
A:
1. **設定** → **サムネイル設定** → **サムネイル生成を有効にする**をチェック
2. キャッシュをクリアして再スキャン
3. 対応画像形式を確認（JPEG/JPG/PNG）

### パフォーマンスの最適化

#### 大量ファイル処理時
1. **Image Ratio**を高めに設定（70-80%）
2. **サムネイルサイズ**を小さくする（64-96px）
3. 不要なフォルダをスキャン対象から除外

#### メモリ使用量を抑える
1. 古いサムネイルキャッシュを定期的に削除
2. **設定** → **サムネイル設定** → **古いキャッシュ削除**を実行

## 📝 対応ファイル形式

### 画像形式
- JPEG/JPG
- PNG
- BMP
- GIF

### アーカイブ形式
- ZIP
- RAR

## 🗂️ ファイルの保存場所

### 設定ファイル
- `%AppData%\ImageMonitor\settings.json`

### データベース
- `%AppData%\ImageMonitor\imagemonitor.db`

### サムネイルキャッシュ
- `%AppData%\ImageMonitor\Thumbnails\`

### ログファイル
- `%AppData%\ImageMonitor\Logs\imagemonitor-YYYYMMDD.log`

## 💡 便利な使い方

### 効率的な検索
1. **Include Archives**を状況に応じて切り替え
2. **Image Ratio**でアーカイブの質をフィルタリング
3. 検索ボックスでファイル名の部分一致検索

### アーカイブ画像の管理
- アーカイブファイル名でシリーズやカテゴリを管理
- Image Ratioで画像中心のアーカイブのみを表示
- サムネイルで内容を素早く確認

### バックアップとメンテナンス
1. 定期的にサムネイルキャッシュをクリア
2. ログファイルの確認でエラーをチェック
3. 設定ファイルのバックアップを推奨

---

## 📞 サポート

### 問題の報告
- エラーが発生した場合は、ログファイル（`%AppData%\ImageMonitor\Logs\`）を確認
- 再現可能な手順があれば記録してください

### 機能要望
- 新機能のご要望やご提案をお寄せください

---

*ImageMonitor v1.0.0 - Based on MovieMonitor*